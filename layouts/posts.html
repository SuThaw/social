<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" type="text/css" media="screen" charset="utf-8">
	<title>Posts</title>
	
</head>
<body ng-app="app">

	<div class="container" ng-controller = 'PostsCtrl'>

		<h1>Recent Posts</h1>
		<form role="form">
			<div class="form-group">
				<div class="input-group">
					<input type="text" ng-model="postBody" class="form-control">
				<span class="input-group-btn">
					<button ng-click="addPost()" class="btn btn-default">Add Post</button>
				</span>
				</div>
				
			</div>				
			
			
		</form>
			<ul class="list-group">
				<li class="list-group-item" ng-repeat="post in posts | orderBy :'-date'">
				<strong>@{{post.username}}</strong>
				<span>{{post.body}}</span>
				</li>


			</ul>
			
	</div>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js" type="text/javascript" charset="utf-8">
		
	</script>
	<script type="text/javascript" charset="utf-8">
		var app = angular.module('app',[]);
		// create the POSTCtrl module
		// dependency inject scope
		app.controller('PostsCtrl',function($scope,$http){
			
			$scope.addPost = function(){
				if($scope.postBody){
					
					$http
						.post('/api/posts',{username:'suthaw',body:$scope.postBody})
						.success(function(post){
							$scope.posts.unshift({
								username:'dickeyxxx',
								body:$scope.postBody	
							});
							$scope.postBody = null;
						
						});
				}
			};
			$http
				.get('http://localhost:3000/api/posts')
				.success(function(posts){
					$scope.posts = posts;
					});
		});
	</script>
</body>
</html>
